
    #INCLUDE p16f84.inc
    
    #DEFINE BUTTON PORTA,0
    
COMPT1 EQU 0x0D
COMPT2 EQU 0x0E   
INDEX EQU 0x0F 
    
BANK0 MACRO
    BCF STATUS,RP0
    ENDM
BANK1 MACRO
    BSF STATUS,RP0
    ENDM
    
    ORG 0x00
    GOTO START
    
START ORG 0x05
    BANK1
    MOVLW 0xFF
    MOVWF TRISA
    CLRF TRISB
    BANK0
    CLRF PORTA
    CLRF PORTB
    MOVLW 0x00
    MOVWF INDEX
    GOTO BOUCLE
    
BOUCLE
    BTFSS BUTTON
    GOTO BOUCLE
    ;CALL INCREMENT
    CALL INCREMENT2 ;;;
    CALL AFFICHER   ;;;
    MOVWF PORTB
    CALL DELAY
    GOTO BOUCLE
    
INCREMENT2
    MOVLW 0x06
    SUBWF INDEX, 0
    BTFSC STATUS,Z
    GOTO RETOUR_TO_ONE
    GOTO ADD_ONE
    
RETOUR_TO_ONE
    MOVLW 0x01
    MOVWF INDEX
    RETURN
    
ADD_ONE
    INCF INDEX, 1
    RETURN
    
AFFICHER
    
    MOVF INDEX, 0
    ADDWF PCL, 1
    NOP
    RETLW 0x06
    RETLW 0x5B
    RETLW 0x4F
    RETLW 0x66
    RETLW 0x6D
    RETLW 0x7D
    
INCREMENT
    MOVF PORTB, 0
    SUBLW 0x06 ;1
    BTFSC STATUS,Z
    RETLW 0x5B
    
    MOVF PORTB, 0
    SUBLW 0x5B ;2
    BTFSC STATUS,Z
    RETLW 0x4F
    
    MOVF PORTB, 0
    SUBLW 0x4F ;3
    BTFSC STATUS,Z
    RETLW 0x66
    
    MOVF PORTB, 0
    SUBLW 0x66 ;4
    BTFSC STATUS,Z
    RETLW 0x6D
    
    MOVF PORTB, 0
    SUBLW 0x6D ;5
    BTFSC STATUS,Z
    RETLW 0x7D
    
    MOVF PORTB, 0
    SUBLW 0x7D ;6
    BTFSC STATUS,Z
    RETLW 0x06
   
;0x06 0x5B 0x4F 0x66 0x6D 0x7D
    
DELAY
    MOVLW .64
    MOVWF COMPT1
    MOVLW .64
    MOVWF COMPT2
    GOTO DELAY1
DELAY1
    DECFSZ COMPT1
    GOTO DELAY2
    RETURN
DELAY2
    DECFSZ COMPT2
    GOTO DELAY2
    GOTO DELAY1
    
    END